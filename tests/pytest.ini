[pytest]
addopts = -q -ra --cov=.
testpaths = tests
``>

---

# 3) Viết fixtures: app, client, reset data

**`tests/conftest.py`**
```python
import pytest
from app import create_app
from routes import tasks as tasks_mod

@pytest.fixture()
def app():
    app = create_app()
    app.config.update({"TESTING": True})
    yield app

@pytest.fixture()
def client(app):
    return app.test_client()

# Đảm bảo dữ liệu "in-memory" sạch trước mỗi test
@pytest.fixture(autouse=True)
def reset_tasks(monkeypatch):
    # tasks là list toàn cục trong routes/tasks.py
    # Gán lại list mới cho mỗi test để không rò rỉ state
    monkeypatch.setattr(tasks_mod, "tasks", [])

#TESTING=True giúp Flask ném lỗi dễ thấy & dùng test client tốt hơn.
#autouse=True khiến fixture chạy tự động trước mỗi test → state sạch.